<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Gaming Assistant | GameVibe Arena</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        .ai-container {
            max-width: 800px;
            margin: 100px auto 2rem;
            padding: 2rem;
            background: rgba(30, 34, 45, 0.9);
            border-radius: 15px;
            border: 2px solid rgba(106, 130, 251, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .ai-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .ai-header h1 {
            background: linear-gradient(90deg, #6a82fb 0%, #fc5c7d 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }
        
        .ai-header p {
            color: #bdc3c7;
            font-size: 1.1rem;
        }
        
        .api-key-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .api-key-section h3 {
            color: #fff;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .api-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .api-input-group input {
            flex: 1;
            padding: 0.8rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
        }
        
        .api-input-group input:focus {
            outline: none;
            border-color: #6a82fb;
            background: rgba(255, 255, 255, 0.15);
        }
        
        .api-status {
            font-size: 0.9rem;
            padding: 0.5rem;
            border-radius: 5px;
            margin-top: 0.5rem;
        }
        
        .api-status.success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .api-status.error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .chat-container {
            height: 400px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow-y: auto;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 1rem;
        }
        
        .message {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 10px;
            max-width: 80%;
        }
        
        .message.user {
            background: linear-gradient(45deg, #6a82fb, #fc5c7d);
            color: white;
            margin-left: auto;
            text-align: right;
        }
        
        .message.ai {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .message.system {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            border: 1px solid rgba(241, 196, 15, 0.3);
            text-align: center;
            margin: 0 auto;
            font-style: italic;
        }
        
        .input-section {
            display: flex;
            gap: 1rem;
        }
        
        .input-section input {
            flex: 1;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
        }
        
        .input-section input:focus {
            outline: none;
            border-color: #6a82fb;
            background: rgba(255, 255, 255, 0.15);
        }
        
        .send-btn {
            padding: 1rem 2rem;
            background: linear-gradient(45deg, #6a82fb, #fc5c7d);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 130, 251, 0.4);
        }
        
        .send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .quick-questions {
            margin-top: 1rem;
        }
        
        .quick-questions h4 {
            color: #fff;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .quick-btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .quick-btn:hover {
            background: rgba(106, 130, 251, 0.3);
            border-color: #6a82fb;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #6a82fb;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-2px);
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-btn">‚Üê Back to Home</a>
    
    <div class="ai-container">
        <div class="ai-header">
            <h1>ÔøΩ AI Tournament Analyzer</h1>
            <p>Smart tournament bracket generation and match outcome predictions powered by AI</p>
        </div>
        
        <!-- API Key Section -->
        <div class="api-key-section">
            <h3>üîë OpenAI API Configuration</h3>
            <div class="api-input-group">
                <input type="password" id="apiKeyInput" placeholder="Enter your OpenAI API Key (sk-...)" />
                <button onclick="saveApiKey()" class="btn-primary">Save Key</button>
            </div>
            <div id="apiStatus" class="api-status" style="display: none;"></div>
            <p style="color: #95a5a6; font-size: 0.9rem; margin-top: 0.5rem;">
                üí° Your API key is stored locally and never sent to our servers
            </p>
        </div>
        
        <!-- Chat Interface -->
        <div class="chat-container" id="chatContainer">
            <div class="message system">
                Welcome! I'm your AI Gaming Assistant. Save your OpenAI API key above to start chatting!
            </div>
        </div>
        
        <!-- Input Section -->
        <div class="input-section">
            <input type="text" id="messageInput" placeholder="Ask me about gaming strategies, tournament tips, or anything gaming related..." disabled />
            <button onclick="sendMessage()" id="sendBtn" class="send-btn" disabled>Send</button>
        </div>
        
        <!-- Quick Questions -->
        <div class="quick-questions">
            <h4>üí° Quick Questions:</h4>
            <span class="quick-btn" onclick="askQuickQuestion('What are the best strategies for FPS tournaments?')">FPS Tournament Tips</span>
            <span class="quick-btn" onclick="askQuickQuestion('How can I improve my gaming performance?')">Performance Tips</span>
            <span class="quick-btn" onclick="askQuickQuestion('What should I consider when organizing a tournament?')">Tournament Organization</span>
            <span class="quick-btn" onclick="askQuickQuestion('How do I build a strong gaming team?')">Team Building</span>
        </div>
    </div>

    <script>
        let apiKey = localStorage.getItem('openai_api_key') || '';
        let isApiKeyValid = false;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            if (apiKey) {
                document.getElementById('apiKeyInput').value = apiKey;
                validateApiKey();
            }
            
            // Enter key support
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        });

        function saveApiKey() {
            const keyInput = document.getElementById('apiKeyInput');
            const newKey = keyInput.value.trim();
            
            if (!newKey) {
                showApiStatus('Please enter an API key', 'error');
                return;
            }
            
            if (!newKey.startsWith('sk-')) {
                showApiStatus('API key should start with "sk-"', 'error');
                return;
            }
            
            apiKey = newKey;
            localStorage.setItem('openai_api_key', apiKey);
            validateApiKey();
        }

        async function validateApiKey() {
            if (!apiKey) return;
            
            showApiStatus('Validating API key...', 'info');
            
            try {
                const response = await fetch('https://api.openai.com/v1/models', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    isApiKeyValid = true;
                    showApiStatus('‚úÖ API key is valid! You can now chat with the AI.', 'success');
                    enableChat();
                } else {
                    isApiKeyValid = false;
                    showApiStatus('‚ùå Invalid API key. Please check and try again.', 'error');
                    disableChat();
                }
            } catch (error) {
                isApiKeyValid = false;
                showApiStatus('‚ùå Error validating API key. Check your internet connection.', 'error');
                disableChat();
            }
        }

        function showApiStatus(message, type) {
            const statusEl = document.getElementById('apiStatus');
            statusEl.textContent = message;
            statusEl.className = `api-status ${type}`;
            statusEl.style.display = 'block';
        }

        function enableChat() {
            document.getElementById('messageInput').disabled = false;
            document.getElementById('sendBtn').disabled = false;
            document.getElementById('messageInput').placeholder = 'Ask me about gaming strategies, tournament tips, or anything gaming related...';
            
            // Add welcome message from AI
            addMessage('ai', 'Hello! I\'m your AI Gaming Assistant. I can help you with:\n\n‚Ä¢ Tournament strategies and tips\n‚Ä¢ Gaming performance optimization\n‚Ä¢ Team building advice\n‚Ä¢ Game-specific strategies\n‚Ä¢ Tournament organization\n\nWhat would you like to know?');
        }

        function disableChat() {
            document.getElementById('messageInput').disabled = true;
            document.getElementById('sendBtn').disabled = true;
            document.getElementById('messageInput').placeholder = 'Please enter a valid API key first...';
        }

        function askQuickQuestion(question) {
            if (!isApiKeyValid) {
                showApiStatus('Please enter a valid API key first', 'error');
                return;
            }
            
            document.getElementById('messageInput').value = question;
            sendMessage();
        }

        async function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message || !isApiKeyValid) return;
            
            // Add user message
            addMessage('user', message);
            messageInput.value = '';
            
            // Show AI typing
            const typingId = addMessage('ai', '<div class="loading"></div> AI is thinking...');
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are a helpful AI Gaming Assistant for GameVibe Arena, a tournament management platform. You specialize in gaming strategies, tournament organization, team building, performance optimization, and general gaming advice. Keep responses helpful, concise, and focused on gaming topics. Use emojis occasionally to make responses more engaging.'
                            },
                            {
                                role: 'user',
                                content: message
                            }
                        ],
                        max_tokens: 500,
                        temperature: 0.7
                    })
                });
                
                const data = await response.json();
                
                if (response.ok && data.choices && data.choices[0]) {
                    const aiResponse = data.choices[0].message.content;
                    updateMessage(typingId, aiResponse);
                } else {
                    updateMessage(typingId, '‚ùå Sorry, I encountered an error. Please try again or check your API key.');
                }
                
            } catch (error) {
                updateMessage(typingId, '‚ùå Network error. Please check your internet connection and try again.');
                console.error('AI Error:', error);
            }
        }

        function addMessage(type, content) {
            const chatContainer = document.getElementById('chatContainer');
            const messageEl = document.createElement('div');
            const messageId = 'msg-' + Date.now();
            
            messageEl.id = messageId;
            messageEl.className = `message ${type}`;
            messageEl.innerHTML = content.replace(/\n/g, '<br>');
            
            chatContainer.appendChild(messageEl);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            return messageId;
        }

        function updateMessage(messageId, newContent) {
            const messageEl = document.getElementById(messageId);
            if (messageEl) {
                messageEl.innerHTML = newContent.replace(/\n/g, '<br>');
            }
        }
    </script>
</body>
</html>
